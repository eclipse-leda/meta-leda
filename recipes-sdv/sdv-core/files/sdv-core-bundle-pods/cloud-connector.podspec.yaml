apiVersion: v1
kind: Pod
metadata:
  name: sdv-core-cloud-agent-pod
spec:
  restartPolicy: Always
  hostAliases:
  - ip: "10.42.0.1"
    hostnames:
    - "edgehost"
  containers:
    - name: cloudagent
      image: ghcr.io/softwaredefinedvehicle/swdc-os-cloud-agent/cloudagent:v0.1
      env:
        - name: CONNECTION_STRING
          valueFrom:
          secretKeyRef:
            name: cloudagent
            key: PrimaryConnectionString
            optional: false
        - name: LOCAL_ADDRESS
          value: tcp://10.42.0.1:1883
        - name: LOG_FILE
          value: ""
        - name: CA_CERT_PATH
          value: "/config/iothub.crt"
        - name: MESSAGE_MAPPER_CONFIG
          value: "/config/message-mapper-config.json"
      imagePullPolicy: IfNotPresent